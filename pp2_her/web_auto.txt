<html>

   <head>
     <title>CGI App</title>
     <script>
function addVehicle() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
	console.log("resp ", this.responseText);
	var retJsonObj = JSON.parse(this.responseText);
	console.log("resp json", retJsonObj);
      	document.getElementById("demo").innerHTML = "received string: "+ this.responseText;
    }
  };
  var vehicle = {};
  var make = document.getElementById("make").value;
  var color = document.getElementById("color").value;
  var year = parseInt(document.getElementById("year").value);
  vehicle.make = make;
  vehicle.color = color;
  vehicle.year = year;
  var val = JSON.stringify(vehicle);
  console.log("v obj ", vehicle);
  console.log("v ", val);
  xhttp.open("POST", "cgi-bin/auto.cgi", true);
//  xhttp.send(val);
  
  var dealership = {name:"Brown Auto", city:"Atlanta"};
  var autoApp = {}; //controller
  autoApp.dealer = dealership;
  autoApp.auto = vehicle;
  var jsonObj = JSON.stringify(autoApp);
  
  xhttp.send(jsonObj);

//var obj = JSON.parse(text);
}
function sendcgi() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
  console.log("resp ", this.responseText);
      document.getElementById("demo").innerHTML = this.responseText;
    }
  };
  xhttp.open("GET", "w?name=hi", true);
  xhttp.send();

//var obj = JSON.parse(text);
}
     </script>


   </head>
   <body>
	make: <input id="make"></input> <br>
	year: <input id="year"></input> <br>
	color: <input id="color"></input> <br>
  	<button type="button" onclick="addVehicle()">Add Vehicle</button>
	<div id="demo"></div>
   </body>


</html>
